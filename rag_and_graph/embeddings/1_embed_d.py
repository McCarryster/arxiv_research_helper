from sentence_transformers import SentenceTransformer
from typing import List
import torch

from config import *

# 1. Initialize qwen embedder using vLLM
# 2. It will take a batch of final papers
# 


# embed try:
model = SentenceTransformer(MODEL_PATH)

chunk = "In many scientific disciplines, such as engineering, astrophysics, life sciences and economics, modern data analysis techniques are becoming increasingly popular as a means of understanding the underlying complex dynamics Email address: marwan@pik-potsdam.de (Norbert Marwan) of the system. Methods for estimating fractal or correlation dimensions, Lyapunov exponents, and mutual information have been widely used [1,2,3,4]. However most of these methods require long data series and in particular their uncritical application, especially to real-world data, may often lead to pitfalls.\nIn the last two decades, the method of recurrence plots has been developed as another approach to describe complex dynamics [5]. A recurrence plot (RP) is the graphical representation of a binary symmetric square matrix which encodes the times when two states are in close proximity (i.e. neighbours in phase space). Based on such a recurrence matrix, a large and diverse amount of information on the dynamics of the system can be extracted and statistically quantified (using recurrence quantification analysis, dynamical invariants, etc.). Meanwhile this technique has been the subject of much interest from various disciplines [6] and it has been successfully applied to a number of areas: the detection of dynamical transitions [7,8] and synchronisation [9], the study of protein structures [10,11] and in cardiac and bone health conditions [12,13], in ecological regimes [14,15], economical dynamics [16,17], in chemical reactions [18] and to monitor mechanical behaviour and damages in engineering [19,20], to name a few. It is important to emphasise that recurrence plot based techniques are even useful for the analysis of short and non-stationary data, which often presents a critical issue when studying real world data. The last few years have witnessed great progress in the development of RP-based approaches for the analysis of complex systems [5,21,22,23,24].\nDuring the last decade, complex networks have become rather popular for the analysis of complex and, in particular, spatially extended systems [25,26,27,28]. Local and global properties (statistical measures) of complex networks are helpful to understand complex interrelations and information flow between different components in extended systems, such as social, computer or neural networks [25], food webs, transportation networks, power grids [29], or even in the global climate system [30]. The basis of complex network analysis is the adjacency matrix, representing the links between the nodes of the network. Like the recurrence matrix, the adjacency matrix is also square, binary, and symmetric (in the case of an unweighted and undirected network).\nIn fact, the recurrence matrix and the adjacency matrix exhibit a strong analogy: a recurrence matrix represents neighbours in phase space and an adjacency matrix represents links in a network; both matrices embody a pair-wise test of all components (phase space vectors resp. nodes). Therefore, we might well proceed to explore further analogies even in the statistical analysis of both the recurrence and the adjacency matrix.\nQuantitative descriptors of RPs have been first introduced in a heuristic way in order to distinguish different appearances of RPs [6]. We may also consider to apply measures of complex network theory to a RP in order to quantify the RP's structure and the corresponding topology of the underlying phase space trajectory. In this (more heuristic) sense, it is actually not necessary to consider the phase space trajectory as a network.\nRecently, the very first steps in the direction of bridging complex network theory and recurrence analysis have been reported [31,32]. In these works, the local properties of phase space trajectories have been studied using complex network measures. Zhang et al. suggested using cycles of the phase space trajectory as nodes and considering a link when two cycles are rather similar [32,33]. The resulting adjacency matrix can be in fact interpreted as a special recurrence matrix. The recurrence criterion here is the matching of two cycles. A complementary approach was suggested by Xu et al. who studied the structural shape of the direct neighbourhood of the phase space trajectory by a motif classification [31]. The adjacency matrix of the underlying network corresponds to the recurrence matrix, using the recurrence criterion of a fixed number of neighbours (instead of the more often used fixed size of the neighbourhood [5]).\nOther approaches for the study of time series by a complex network analysis suggested using linear correlations [34] or another certain condition on the time series amplitudes (\"visibility\") [35].\nIn this letter, we demonstrate that the recurrence matrix (analogously to [31]) can be considered as the adjacency matrix of an undirected, unweighted network, allowing us to study time series using a complex network approach. This ansatz on creating complex network is more natural and simple than the various suggested approaches [33,34,35]. Complex network statistics is helpful to characterise the local and global properties of a network. We propose using these complex network measures for a quantitative description of recurrence matrices. By applying these measures, we obtain additional information from the recurrence plots, which can be used for characterising the dynamics of the underlying process. We give an interpretation of this approach in the context of the dynamics of a phase space trajectory. Nevertheless, many of these measures neither have an analogue in traditional RQA nor in nonlinear time series analysis in a wider sense, and hence, open up new perspectives for the quantitative analysis of dynamical systems. We illustrate our approach with a prototypical model system and a real-world example from the Earth sciences."
chunk_embeddings = model.encode(chunk)
print(chunk_embeddings.shape)

chunks = ["text 1", "text 2"]
# chunk_embeddings = model.encode(chunks)
chunk_embeddings = model.encode(chunks, batch_size=32, show_progress_bar=True)
print(chunk_embeddings.shape)